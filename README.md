import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# Данные о произведениях
data = {
    "Название": [
        "Избранные труды. В двух томах. Том 1",
        "Избранные труды. В двух томах. Том 2",
        "Т. 49 Ежегодник Япония. 2020",
        "Диван ал-Мамнун",
        "Суфизм без границ",
        "Этимологический словарь иранских языков. Т.6",
        "Вайдурья онбо (Гирлянда голубого берилла)",
        "пер. с санскрита Упанишады",
        "пер. с пали Дигха-никая",
        "пер. с кит. Сутры эзотерического буддизма",
        "Язык китайского интернета",
        "Волшебное сокровище сновидений / пер. с санскрита",
        "Сантальский язык",
        "Социализм в Китае (1919–1965)",
        "Дравьясанграха-вритти",
        "медицине : как сохранить здоровье / пер. с китайского",
        "китайской культуры : очерки / пер. с китайского",
        "Очерки изучения буддизма древней Индии",
        "мечта :",
        "кяхтинского пиджина",
        "на ветру :",
        "Социальная организация северных тунгусов",
        "Я буду умницей",
        "Пейзаж",
        "династии Чжоу (Чжоу ли)",
        "Циньские напевы",
        "китайские боевые искусства",
        "(Шара туджи)",
        "символ китайской культуры",
    ],
    "Автор": [
        "Сыркин А.Я.", "Сыркин А.Я.", "Ежегодник Япония", "Гасан Алкадари",
        "И.В. Зайцев", "Эдельман Д.И.", "Дэсрид Санчжай-чжамцо", "Упанишады",
        "Дигха-никая", "Сутры эзотерического буддизма", "Сбоев А.Н.",
        "Джагаддева", "Фризен Вальтер", "Юй Юцзюнь", "Брахмадева",
        "О китайской", "Символы", "Андросов В. П.", "Китайская", 
        "Словари", "Блуждающий", "Широкогоров С.М.", "Хуан Бэйцзя",
        "Фан Фан", "Установления", "Цзя Пинва", "Ушу —", "Желтая история",
        "Чай —"
    ],
    "Год": [
        2020, 2020, 2020, 2020, 2020, 2020, 2020, 2019, 2020, 
        2020, 2020, 2019, 2019, 2019, 2019, 2018, 2018, 2018,
        2018, 2018, 2018, 2017, 2017, 2017, 2017, 2017, 2017,
        2017, 2017, 2017, 2017, 2017
    ]
}

# Создание DataFrame
df = pd.DataFrame(data)

# Заголовок приложения
st.title("Визуализация избранных трудов")

# Список авторов для фильтрации
authors = df['Автор'].unique()
selected_authors = st.multiselect("Выберите авторов для фильтрации:", authors)

# Фильтрация данных по выбранным авторам
if selected_authors:
    filtered_df = df[df['Автор'].isin(selected_authors)]
else:
    filtered_df = df

# Гистограмма по годам
plt.figure(figsize=(12, 6))
filtered_df['Год'].value_counts().sort_index().plot(kind='bar')
plt.title("Количество трудов по годам (фильтр по авторам)")
plt.xlabel("Год")
plt.ylabel("Количество трудов")
plt.xticks(rotation=45)
st.pyplot(plt)

# Таблица с filtered_df
st.subheader("Таблица отфильтрованных трудов")
st.dataframe(filtered_df)
